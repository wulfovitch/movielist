<%= javascript 'sortable' %>
<% title "movie list" %>

<h2>
	Movie List
</h2>

<p style="float: right;">
	<%= link_to 'toggle grouped user view', togglegroupedview_url %>
</p>

<%- if @user.show_grouped_by_user == true -%>

	<%- @movies_users.sort.each do |user, movies| -%>
	  <h3><%= user %> (<%= movies.length %>)</h3>
		<table width="100%" class="sortable" id="sortabletable_<%= user %>">
			<tr>
	      <th>movie title</th>
				<th>movie original title</th>
				<th class="unsortable">imdb link</th>
				<th>bought at</th>
				<th>media type</th>
				<th>disc type</th>
				<th>parental rating</th>
	    </tr>
	  <%- for movie in movies -%>
	    <tr>
	      <td><%= link_to movie.movie_title, movie_url(movie) %></td>
				<td><%= movie.movie_original_title %></td>
				<td><%= link_to "imdb link", movie.imdb_link %></td>
				<td><%= movie.created_at.strftime('%Y-%m-%d') %></td>
				<td><%= movie.media_type %></td>
				<td><%= movie.disc_type %></td>
				<td><%= movie.parental_rating %></td>
	    </tr>
	  <%- end -%>
		</table>
	  <br />
	<%- end -%>
	
<%- else -%>

	<h3>All movies (<%= @movies.length %>)</h3>
	<table width="100%" class="sortable" id="sortabletable">
		<tr>
	    <th>movie title</th>
			<th>movie original title</th>
			<th class="unsortable">imdb link</th>
			<th>bought at</th>
			<th>media type</th>
			<th>disc type</th>
			<th>parental rating</th>
			<th>owner</th>
	  </tr>
	<%- for movie in @movies -%>
    <tr>
      <td><%= link_to movie.movie_title, movie_url(movie) %></td>
			<td><%= movie.movie_original_title %></td>
			<td><%= link_to "imdb link", movie.imdb_link %></td>
			<td><%= movie.created_at.strftime('%Y-%m-%d') %></td>
			<td><%= movie.media_type %></td>
			<td><%= movie.disc_type %></td>
			<td><%= movie.parental_rating %></td>
			<td><%= movie.user.realname %></td>
    </tr>
  <%- end -%>
	</table>
  <br />
<%- end -%>